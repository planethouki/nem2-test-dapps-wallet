const hash = require('../../src/assets/utils/hash')

describe('hash', () => {
  describe('getTransactionHash', () => {
    test('transferTransaction', () => {
      const { getTransactionHash } = hash
      const g = '6C1B92391CCB41C96478471C2634C111D9E989DECD66130C0430B5B8D20117CD'
      const p = 'B000000000000000123AF01746042B9F01F1E429EFC3B3CE4EA82C02E54E548B04C721A3BB1EB8A3619980F361B9AEA9942BC11504E2D5E801C7884AFBFE5136E6E3D6DF212AE40E1B9BBCAB6DDAB54C3534F3C47B0E42518435CB767F55743C97D09A12A1EC0B490000000001985441204E0000000000000529DE0208000000988063F3D1382D8715866432067E251B0106ADD4868428BC0000010000000000EEAFF441BA994BE7EBB39274FB000000'
      const h = 'DD7C0A664F804E5651C557A57B16E7A189F727E18AD282B578710991A1102B6C'
      expect(getTransactionHash(p, g)).toBe(h)
    })
    test('aggregateCompleteTransaction', () => {
      const { getTransactionHash } = hash
      const g = '3B5E1FA6445653C971A50687E75E6D09FB30481055E3990C84B25E9222DC1155'
      const p = "6801000000000000064CB43EE333A131D7ED3899E6775EC9AA8B1B610C266A0873AFAAFCAC1B5CD9B15ECC219439D644DA40B93444E7588968D4263821C12DC28EA97ECFBB26CB0DC65B49BA7673BFEC3EFD04DE7EF412A6346F4BA745AAC09649E8CAFE1AC385800000000001984141400D030000000000E80FD6B90200000018D046A949D93120FAA5CE4538618EEFB4B505E469CD0C24F97FA35929038B23C0000000000000006000000000000000C65B49BA7673BFEC3EFD04DE7EF412A6346F4BA745AAC09649E8CAFE1AC38580000000000198544198BA065557AC6CE48DE3D757F6614ACA96C37DA325423C1F00000100000000003CE19A057E831F0901000000000000006000000000000000C65B49BA7673BFEC3EFD04DE7EF412A6346F4BA745AAC09649E8CAFE1AC385800000000001985441982568210C57B972E6653F43240DA9A81D04787920A4914D00000100000000003CE19A057E831F090100000000000000"
      const h = "867EF7BC03B68E6E57B7807FBA17A317F74B1F2FDB1BD58E6889C992E9D89D89"
      expect(getTransactionHash(p, g)).toBe(h)
    })
    test('aggregateBondedTransaction', () => {
      const { getTransactionHash } = hash
      const g = '3B5E1FA6445653C971A50687E75E6D09FB30481055E3990C84B25E9222DC1155'
      const p = "1801000000000000FE1E8E7C641F4E94C5D4BE0CB7CCBA3A625D792B2D2C15BB6BCCF56F079C3D9483DD5D983BCBD5F5413B9A4B29FFCC252A34F4C84A9C29B3991BC280F63FAE08DFF2D798CF331CDDEC64FD9F8F565B3A78D3423700955B2EE03BDBD09F01E1710000000001984142400D030000000000C6150FBA020000009C28AF8CA66117FBAAB83387CD63FD2F78AF447C28BD097060C8A6A2565F3D1670000000000000006B00000000000000DFF2D798CF331CDDEC64FD9F8F565B3A78D3423700955B2EE03BDBD09F01E17100000000019854419814F3DABC922F7B2D06A6AF544B58E5CFA2099C91B0077C0B000100000000003CE19A057E831F0900E40B540200000000386D544575416932746A0000000000"
      const h = "C876892898BFE47FC4124537944D9EE82CD9C4F6F49E0A538148883F37F29EBC"
      expect(getTransactionHash(p, g)).toBe(h)
    })
  })

  test('publicKeyToHexAddress', () => {
    const publicKey = '713FA4446275F62173186194F4FE898917BC2C05C9273E000461951A3557A255'
    const addressPlain = 'TC7ULQWT6A3Z6GTCMJUQSCD5G6YZNOVPVZ7UYPA'
    const addressPretty = 'TC7ULQ-WT6A3Z-6GTCMJ-UQSCD5-G6YZNO-VPVZ7U-YPA'
    const rawAddress = '98BF45C2D3F0379F1A62626909087D37B196BAAFAE7F4C3C'
    const { publicKeyToHexAddress } = hash
    expect(publicKeyToHexAddress(publicKey)).toBe(rawAddress)
  })

  test('publicKeyToHexAddressPrefix', () => {
    const publicKey = '713FA4446275F62173186194F4FE898917BC2C05C9273E000461951A3557A255'
    const rawAddressTest = '98BF45C2D3F0379F1A62626909087D37B196BAAFAE7F4C3C'
    const rawAddressMain = '68BF45C2D3F0379F1A62626909087D37B196BAAFAE96D6AB'
    const { publicKeyToHexAddress } = hash
    expect(publicKeyToHexAddress(publicKey, 152)).toBe(rawAddressTest)
    expect(publicKeyToHexAddress(publicKey, 104)).toBe(rawAddressMain)
  })

  test('hashPassword', () => {
    const h = hash.hashPassword('hoge')
    expect(h.length).toBe(64)
    expect(h).toMatch(/[A-F\d]+/)
  })
})
